<!doctype html>
<html>
	<head>
	<title>cbVid</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Lato">
	<link rel="stylesheet" href="//releases.flowplayer.org/6.0.3/skin/functional.css">
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script src="//releases.flowplayer.org/6.0.3/flowplayer.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-animate.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-cookies.js"></script>
	<script src="./socket.io/socket.io.js"></script>
	<script src="./crypto/jsrp-browser.js"></script>
	<script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
	<script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/aes.js"></script>
	<script src="./ui-bootstrap-tpls-0.13.4.min.js"></script>
	<script src="controllers.js"></script>
	<script src="directives.js"></script>
	<script src="services.js"></script>
	<style type="text/css">
		body { font-family: 'Lato', serif; }
	</style>
</head>
<body ng-app="cbVidApp" style="background-color: #F8F8F8" oncontextmenu="return false;">
	<div ng-controller="mainController" style="height: 100%" drag-and-drop>
		
		<script type="text/ng-template" id="uploadForm.html">
			<div class="modal-header">
				<h3 class="modal-title">Upload A Video</h3>
			</div>
			<div class="modal-body">
    			<table cellpadding="20" cellspacing="0" border="0" width="100%">
					<tr>
						<td align="center">
							<table cellpadding="20" cellspacing="0" border="1">
								<tr>
									<td><b>Expected</b></td>
									<td><b>Input</b></td>
									<td><b>Action</b></td>
								</tr>
								<tr>
									<td>File:</td>
									<td><input type="file" id="file"></td>
									<td><button id="upload" ng-click="upload()">Upload</button></td>
								</tr>
								<tr>
									<td>Magnet Link:</td>
									<td><input type="text" ng-model="torrentLink" class="loginctrl"></td>
									<td><button id="torrent" ng-click="sendTorrent()">Torrent</button></td>
								</tr>
								<tr>
									<td colspan="3">
										<table cellpadding="20" cellspacing="0" border="0" width="100%">
											<tr ng-if="viewers.length > 0">
												<td align="center">
													<table cellpadding="20" cellspacing="0" border="0" style="border: 1px solid black">
														<tr>
															<td>Viewer</td>
															<td>Action</td>
														</tr>
														<tr ng-repeat="user in viewers">
															<td>
																<input ng-model="user.username" ng-change="checkViewers()" ng-trim="false" maxlength="20" class="loginctrl" type="text"/>
															</td>
															<td>
																<button ng-click="viewers.splice($index, 1)">Remove</button>
															</td>
														</tr>
													</table>
												</td>
											</tr>
											<tr>
												<td align="center">
													<button ng-click="viewers.push({username: ''})">Add Viewer</button>
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</div>
			<div class="modal-footer">
				<button class="btn btn-primary" type="button" ng-click="ok()">Close</button>
			</div>
		</script>
		<script type="text/ng-template" id="progressForm.html">
			<div class="modal-header">
				<h3 class="modal-title">Video Progress</h3>
			</div>
			<div class="modal-body">
				<table cellpadding="20" cellspacing="0" border="0" width="100%">
					<tr ng-hide="uploading | isEmpty" ng-repeat="(file, details) in uploading">
						<td align="center" style="border-top: 1px solid black; border-bottom: 1px solid black">
							<div style="padding-top: 10px; padding-bottom: 10px">{{file}}</div>
							<progressbar style="max-width: 400px" max="100" value="details.percent" type="success"><b>{{details.percent}}%</b></progressbar>
						</td>
					</tr>
					<tr ng-hide="processing | isEmpty" ng-repeat="(md5, details) in processing">
						<td align="center" style="border-top: 1px solid black; border-bottom: 1px solid black">
							<div style="padding-top: 10px; padding-bottom: 10px">{{details.name}}</div>
							<progressbar style="max-width: 400px" ng-if="details.percent" max="100" value="details.percent" type="warning"><b>{{details.percent}}%</b></progressbar>
							<div ng-if="details.name && !details.percent" style="padding-bottom: 10px">Time Processed: {{details.timestamp}}</div>
						</td>
					</tr>
				</table>
			</div>
			<div class="modal-footer">
				<button class="btn btn-primary" type="button" ng-click="ok()">Close</button>
			</div>
		</script>

		<div style="position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 9999999; text-align: center" ng-if="!authed">
			<table width="100%" height="100%" cellspacing="0" cellpadding="0">
				<tr height="100%">
					<td width="100%">
						<loginform></loginform>
					</td>
				</tr>
			</table>
		</div>

		<div ng-show="authed" drag-and-drop style="height: 100%">
			<div style="text-align: center">
				<button ng-click="logout()">Logout</button>
				<button type="button" class="btn btn-default" ng-click="showUploadDialog()">Upload</button>
				<button ng-if="!(uploading | isEmpty) || !(processing | isEmpty)" type="button" class="btn btn-default" ng-click="showProgressDialog()">Progress</button>
			</div>
			<table ng-if="!(videoList | isEmpty)" cellpadding="20" cellspacing="0" border="0" width="100%">
				<tr>
					<td align="center">
						<table cellpadding="20" cellspacing="0" border="1">
							<tr>
								<td><b>Original File Name</b></td>
								<td><b>Delete</b></td>
							</tr>
							<tr ng-repeat="video in videoList | orderBy: 'details.original'" ng-class="{'activevideo': video.filename == activeVideo.filename}">
								<td ng-bind="video.details.original" ng-click="setVideo(video.filename)"></td>
								<td ng-if="video.edit" ng-click="deleteVideo(video.filename)">Delete</td>
								<td ng-if="!video.edit" ng-click="removeMe(video.filename)">Remove</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
			<div style="padding: 20px; text-align: center">
				<div class="player"></div>
			</div>
		</div>

	</div>
</body>
</html>